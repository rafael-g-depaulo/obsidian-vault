/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var fn=Object.create;var he=Object.defineProperty;var un=Object.getOwnPropertyDescriptor;var dn=Object.getOwnPropertyNames;var hn=Object.getPrototypeOf,gn=Object.prototype.hasOwnProperty;var pn=(d,i)=>()=>(i||d((i={exports:{}}).exports,i),i.exports),bn=(d,i)=>{for(var s in i)he(d,s,{get:i[s],enumerable:!0})},qe=(d,i,s,c)=>{if(i&&typeof i=="object"||typeof i=="function")for(let f of dn(i))!gn.call(d,f)&&f!==s&&he(d,f,{get:()=>i[f],enumerable:!(c=un(i,f))||c.enumerable});return d};var Ze=(d,i,s)=>(s=d!=null?fn(hn(d)):{},qe(i||!d||!d.__esModule?he(s,"default",{value:d,enumerable:!0}):s,d)),mn=d=>qe(he({},"__esModule",{value:!0}),d);var Ie=pn((et,Re)=>{(function(d){if(typeof et=="object"&&typeof Re!="undefined")Re.exports=d();else if(typeof define=="function"&&define.amd)define([],d);else{var i;typeof window!="undefined"?i=window:typeof global!="undefined"?i=global:typeof self!="undefined"?i=self:i=this,i.localforage=d()}})(function(){var d,i,s;return function c(f,x,y){function T(E,I){if(!x[E]){if(!f[E]){var u=typeof require=="function"&&require;if(!I&&u)return u(E,!0);if(p)return p(E,!0);var _=new Error("Cannot find module '"+E+"'");throw _.code="MODULE_NOT_FOUND",_}var R=x[E]={exports:{}};f[E][0].call(R.exports,function(w){var A=f[E][1][w];return T(A||w)},R,R.exports,c,f,x,y)}return x[E].exports}for(var p=typeof require=="function"&&require,g=0;g<y.length;g++)T(y[g]);return T}({1:[function(c,f,x){(function(y){"use strict";var T=y.MutationObserver||y.WebKitMutationObserver,p;if(T){var g=0,E=new T(w),I=y.document.createTextNode("");E.observe(I,{characterData:!0}),p=function(){I.data=g=++g%2}}else if(!y.setImmediate&&typeof y.MessageChannel!="undefined"){var u=new y.MessageChannel;u.port1.onmessage=w,p=function(){u.port2.postMessage(0)}}else"document"in y&&"onreadystatechange"in y.document.createElement("script")?p=function(){var N=y.document.createElement("script");N.onreadystatechange=function(){w(),N.onreadystatechange=null,N.parentNode.removeChild(N),N=null},y.document.documentElement.appendChild(N)}:p=function(){setTimeout(w,0)};var _,R=[];function w(){_=!0;for(var N,M,O=R.length;O;){for(M=R,R=[],N=-1;++N<O;)M[N]();O=R.length}_=!1}f.exports=A;function A(N){R.push(N)===1&&!_&&p()}}).call(this,typeof global!="undefined"?global:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],2:[function(c,f,x){"use strict";var y=c(1);function T(){}var p={},g=["REJECTED"],E=["FULFILLED"],I=["PENDING"];f.exports=u;function u(C){if(typeof C!="function")throw new TypeError("resolver must be a function");this.state=I,this.queue=[],this.outcome=void 0,C!==T&&A(this,C)}u.prototype.catch=function(C){return this.then(null,C)},u.prototype.then=function(C,F){if(typeof C!="function"&&this.state===E||typeof F!="function"&&this.state===g)return this;var L=new this.constructor(T);if(this.state!==I){var k=this.state===E?C:F;R(L,k,this.outcome)}else this.queue.push(new _(L,C,F));return L};function _(C,F,L){this.promise=C,typeof F=="function"&&(this.onFulfilled=F,this.callFulfilled=this.otherCallFulfilled),typeof L=="function"&&(this.onRejected=L,this.callRejected=this.otherCallRejected)}_.prototype.callFulfilled=function(C){p.resolve(this.promise,C)},_.prototype.otherCallFulfilled=function(C){R(this.promise,this.onFulfilled,C)},_.prototype.callRejected=function(C){p.reject(this.promise,C)},_.prototype.otherCallRejected=function(C){R(this.promise,this.onRejected,C)};function R(C,F,L){y(function(){var k;try{k=F(L)}catch(W){return p.reject(C,W)}k===C?p.reject(C,new TypeError("Cannot resolve promise with itself")):p.resolve(C,k)})}p.resolve=function(C,F){var L=N(w,F);if(L.status==="error")return p.reject(C,L.value);var k=L.value;if(k)A(C,k);else{C.state=E,C.outcome=F;for(var W=-1,$=C.queue.length;++W<$;)C.queue[W].callFulfilled(F)}return C},p.reject=function(C,F){C.state=g,C.outcome=F;for(var L=-1,k=C.queue.length;++L<k;)C.queue[L].callRejected(F);return C};function w(C){var F=C&&C.then;if(C&&(typeof C=="object"||typeof C=="function")&&typeof F=="function")return function(){F.apply(C,arguments)}}function A(C,F){var L=!1;function k(K){L||(L=!0,p.reject(C,K))}function W(K){L||(L=!0,p.resolve(C,K))}function $(){F(W,k)}var V=N($);V.status==="error"&&k(V.value)}function N(C,F){var L={};try{L.value=C(F),L.status="success"}catch(k){L.status="error",L.value=k}return L}u.resolve=M;function M(C){return C instanceof this?C:p.resolve(new this(T),C)}u.reject=O;function O(C){var F=new this(T);return p.reject(F,C)}u.all=z;function z(C){var F=this;if(Object.prototype.toString.call(C)!=="[object Array]")return this.reject(new TypeError("must be an array"));var L=C.length,k=!1;if(!L)return this.resolve([]);for(var W=new Array(L),$=0,V=-1,K=new this(T);++V<L;)J(C[V],V);return K;function J(j,ne){F.resolve(j).then(re,function(q){k||(k=!0,p.reject(K,q))});function re(q){W[ne]=q,++$===L&&!k&&(k=!0,p.resolve(K,W))}}}u.race=G;function G(C){var F=this;if(Object.prototype.toString.call(C)!=="[object Array]")return this.reject(new TypeError("must be an array"));var L=C.length,k=!1;if(!L)return this.resolve([]);for(var W=-1,$=new this(T);++W<L;)V(C[W]);return $;function V(K){F.resolve(K).then(function(J){k||(k=!0,p.resolve($,J))},function(J){k||(k=!0,p.reject($,J))})}}},{1:1}],3:[function(c,f,x){(function(y){"use strict";typeof y.Promise!="function"&&(y.Promise=c(2))}).call(this,typeof global!="undefined"?global:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{2:2}],4:[function(c,f,x){"use strict";var y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function T(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function p(){try{if(typeof indexedDB!="undefined")return indexedDB;if(typeof webkitIndexedDB!="undefined")return webkitIndexedDB;if(typeof mozIndexedDB!="undefined")return mozIndexedDB;if(typeof OIndexedDB!="undefined")return OIndexedDB;if(typeof msIndexedDB!="undefined")return msIndexedDB}catch(e){return}}var g=p();function E(){try{if(!g||!g.open)return!1;var e=typeof openDatabase!="undefined"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),n=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!e||n)&&typeof indexedDB!="undefined"&&typeof IDBKeyRange!="undefined"}catch(t){return!1}}function I(e,n){e=e||[],n=n||{};try{return new Blob(e,n)}catch(r){if(r.name!=="TypeError")throw r;for(var t=typeof BlobBuilder!="undefined"?BlobBuilder:typeof MSBlobBuilder!="undefined"?MSBlobBuilder:typeof MozBlobBuilder!="undefined"?MozBlobBuilder:WebKitBlobBuilder,o=new t,a=0;a<e.length;a+=1)o.append(e[a]);return o.getBlob(n.type)}}typeof Promise=="undefined"&&c(3);var u=Promise;function _(e,n){n&&e.then(function(t){n(null,t)},function(t){n(t)})}function R(e,n,t){typeof n=="function"&&e.then(n),typeof t=="function"&&e.catch(t)}function w(e){return typeof e!="string"&&(console.warn(e+" used as a key, but it is not a string."),e=String(e)),e}function A(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var N="local-forage-detect-blob-support",M=void 0,O={},z=Object.prototype.toString,G="readonly",C="readwrite";function F(e){for(var n=e.length,t=new ArrayBuffer(n),o=new Uint8Array(t),a=0;a<n;a++)o[a]=e.charCodeAt(a);return t}function L(e){return new u(function(n){var t=e.transaction(N,C),o=I([""]);t.objectStore(N).put(o,"key"),t.onabort=function(a){a.preventDefault(),a.stopPropagation(),n(!1)},t.oncomplete=function(){var a=navigator.userAgent.match(/Chrome\/(\d+)/),r=navigator.userAgent.match(/Edge\//);n(r||!a||parseInt(a[1],10)>=43)}}).catch(function(){return!1})}function k(e){return typeof M=="boolean"?u.resolve(M):L(e).then(function(n){return M=n,M})}function W(e){var n=O[e.name],t={};t.promise=new u(function(o,a){t.resolve=o,t.reject=a}),n.deferredOperations.push(t),n.dbReady?n.dbReady=n.dbReady.then(function(){return t.promise}):n.dbReady=t.promise}function $(e){var n=O[e.name],t=n.deferredOperations.pop();if(t)return t.resolve(),t.promise}function V(e,n){var t=O[e.name],o=t.deferredOperations.pop();if(o)return o.reject(n),o.promise}function K(e,n){return new u(function(t,o){if(O[e.name]=O[e.name]||Ne(),e.db)if(n)W(e),e.db.close();else return t(e.db);var a=[e.name];n&&a.push(e.version);var r=g.open.apply(g,a);n&&(r.onupgradeneeded=function(l){var h=r.result;try{h.createObjectStore(e.storeName),l.oldVersion<=1&&h.createObjectStore(N)}catch(b){if(b.name==="ConstraintError")console.warn('The database "'+e.name+'" has been upgraded from version '+l.oldVersion+" to version "+l.newVersion+', but the storage "'+e.storeName+'" already exists.');else throw b}}),r.onerror=function(l){l.preventDefault(),o(r.error)},r.onsuccess=function(){var l=r.result;l.onversionchange=function(h){h.target.close()},t(l),$(e)}})}function J(e){return K(e,!1)}function j(e){return K(e,!0)}function ne(e,n){if(!e.db)return!0;var t=!e.db.objectStoreNames.contains(e.storeName),o=e.version<e.db.version,a=e.version>e.db.version;if(o&&(e.version!==n&&console.warn('The database "'+e.name+`" can't be downgraded from version `+e.db.version+" to version "+e.version+"."),e.version=e.db.version),a||t){if(t){var r=e.db.version+1;r>e.version&&(e.version=r)}return!0}return!1}function re(e){return new u(function(n,t){var o=new FileReader;o.onerror=t,o.onloadend=function(a){var r=btoa(a.target.result||"");n({__local_forage_encoded_blob:!0,data:r,type:e.type})},o.readAsBinaryString(e)})}function q(e){var n=F(atob(e.data));return I([n],{type:e.type})}function ae(e){return e&&e.__local_forage_encoded_blob}function ft(e){var n=this,t=n._initReady().then(function(){var o=O[n._dbInfo.name];if(o&&o.dbReady)return o.dbReady});return R(t,e,e),t}function ut(e){W(e);for(var n=O[e.name],t=n.forages,o=0;o<t.length;o++){var a=t[o];a._dbInfo.db&&(a._dbInfo.db.close(),a._dbInfo.db=null)}return e.db=null,J(e).then(function(r){return e.db=r,ne(e)?j(e):r}).then(function(r){e.db=n.db=r;for(var l=0;l<t.length;l++)t[l]._dbInfo.db=r}).catch(function(r){throw V(e,r),r})}function Z(e,n,t,o){o===void 0&&(o=1);try{var a=e.db.transaction(e.storeName,n);t(null,a)}catch(r){if(o>0&&(!e.db||r.name==="InvalidStateError"||r.name==="NotFoundError"))return u.resolve().then(function(){if(!e.db||r.name==="NotFoundError"&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),j(e)}).then(function(){return ut(e).then(function(){Z(e,n,t,o-1)})}).catch(t);t(r)}}function Ne(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function dt(e){var n=this,t={db:null};if(e)for(var o in e)t[o]=e[o];var a=O[t.name];a||(a=Ne(),O[t.name]=a),a.forages.push(n),n._initReady||(n._initReady=n.ready,n.ready=ft);var r=[];function l(){return u.resolve()}for(var h=0;h<a.forages.length;h++){var b=a.forages[h];b!==n&&r.push(b._initReady().catch(l))}var m=a.forages.slice(0);return u.all(r).then(function(){return t.db=a.db,J(t)}).then(function(v){return t.db=v,ne(t,n._defaultConfig.version)?j(t):v}).then(function(v){t.db=a.db=v,n._dbInfo=t;for(var S=0;S<m.length;S++){var P=m[S];P!==n&&(P._dbInfo.db=t.db,P._dbInfo.version=t.version)}})}function ht(e,n){var t=this;e=w(e);var o=new u(function(a,r){t.ready().then(function(){Z(t._dbInfo,G,function(l,h){if(l)return r(l);try{var b=h.objectStore(t._dbInfo.storeName),m=b.get(e);m.onsuccess=function(){var v=m.result;v===void 0&&(v=null),ae(v)&&(v=q(v)),a(v)},m.onerror=function(){r(m.error)}}catch(v){r(v)}})}).catch(r)});return _(o,n),o}function gt(e,n){var t=this,o=new u(function(a,r){t.ready().then(function(){Z(t._dbInfo,G,function(l,h){if(l)return r(l);try{var b=h.objectStore(t._dbInfo.storeName),m=b.openCursor(),v=1;m.onsuccess=function(){var S=m.result;if(S){var P=S.value;ae(P)&&(P=q(P));var D=e(P,S.key,v++);D!==void 0?a(D):S.continue()}else a()},m.onerror=function(){r(m.error)}}catch(S){r(S)}})}).catch(r)});return _(o,n),o}function pt(e,n,t){var o=this;e=w(e);var a=new u(function(r,l){var h;o.ready().then(function(){return h=o._dbInfo,z.call(n)==="[object Blob]"?k(h.db).then(function(b){return b?n:re(n)}):n}).then(function(b){Z(o._dbInfo,C,function(m,v){if(m)return l(m);try{var S=v.objectStore(o._dbInfo.storeName);b===null&&(b=void 0);var P=S.put(b,e);v.oncomplete=function(){b===void 0&&(b=null),r(b)},v.onabort=v.onerror=function(){var D=P.error?P.error:P.transaction.error;l(D)}}catch(D){l(D)}})}).catch(l)});return _(a,t),a}function bt(e,n){var t=this;e=w(e);var o=new u(function(a,r){t.ready().then(function(){Z(t._dbInfo,C,function(l,h){if(l)return r(l);try{var b=h.objectStore(t._dbInfo.storeName),m=b.delete(e);h.oncomplete=function(){a()},h.onerror=function(){r(m.error)},h.onabort=function(){var v=m.error?m.error:m.transaction.error;r(v)}}catch(v){r(v)}})}).catch(r)});return _(o,n),o}function mt(e){var n=this,t=new u(function(o,a){n.ready().then(function(){Z(n._dbInfo,C,function(r,l){if(r)return a(r);try{var h=l.objectStore(n._dbInfo.storeName),b=h.clear();l.oncomplete=function(){o()},l.onabort=l.onerror=function(){var m=b.error?b.error:b.transaction.error;a(m)}}catch(m){a(m)}})}).catch(a)});return _(t,e),t}function vt(e){var n=this,t=new u(function(o,a){n.ready().then(function(){Z(n._dbInfo,G,function(r,l){if(r)return a(r);try{var h=l.objectStore(n._dbInfo.storeName),b=h.count();b.onsuccess=function(){o(b.result)},b.onerror=function(){a(b.error)}}catch(m){a(m)}})}).catch(a)});return _(t,e),t}function yt(e,n){var t=this,o=new u(function(a,r){if(e<0){a(null);return}t.ready().then(function(){Z(t._dbInfo,G,function(l,h){if(l)return r(l);try{var b=h.objectStore(t._dbInfo.storeName),m=!1,v=b.openKeyCursor();v.onsuccess=function(){var S=v.result;if(!S){a(null);return}e===0||m?a(S.key):(m=!0,S.advance(e))},v.onerror=function(){r(v.error)}}catch(S){r(S)}})}).catch(r)});return _(o,n),o}function Et(e){var n=this,t=new u(function(o,a){n.ready().then(function(){Z(n._dbInfo,G,function(r,l){if(r)return a(r);try{var h=l.objectStore(n._dbInfo.storeName),b=h.openKeyCursor(),m=[];b.onsuccess=function(){var v=b.result;if(!v){o(m);return}m.push(v.key),v.continue()},b.onerror=function(){a(b.error)}}catch(v){a(v)}})}).catch(a)});return _(t,e),t}function Tt(e,n){n=A.apply(this,arguments);var t=this.config();e=typeof e!="function"&&e||{},e.name||(e.name=e.name||t.name,e.storeName=e.storeName||t.storeName);var o=this,a;if(!e.name)a=u.reject("Invalid arguments");else{var r=e.name===t.name&&o._dbInfo.db,l=r?u.resolve(o._dbInfo.db):J(e).then(function(h){var b=O[e.name],m=b.forages;b.db=h;for(var v=0;v<m.length;v++)m[v]._dbInfo.db=h;return h});e.storeName?a=l.then(function(h){if(h.objectStoreNames.contains(e.storeName)){var b=h.version+1;W(e);var m=O[e.name],v=m.forages;h.close();for(var S=0;S<v.length;S++){var P=v[S];P._dbInfo.db=null,P._dbInfo.version=b}var D=new u(function(B,U){var H=g.open(e.name,b);H.onerror=function(X){var se=H.result;se.close(),U(X)},H.onupgradeneeded=function(){var X=H.result;X.deleteObjectStore(e.storeName)},H.onsuccess=function(){var X=H.result;X.close(),B(X)}});return D.then(function(B){m.db=B;for(var U=0;U<v.length;U++){var H=v[U];H._dbInfo.db=B,$(H._dbInfo)}}).catch(function(B){throw(V(e,B)||u.resolve()).catch(function(){}),B})}}):a=l.then(function(h){W(e);var b=O[e.name],m=b.forages;h.close();for(var v=0;v<m.length;v++){var S=m[v];S._dbInfo.db=null}var P=new u(function(D,B){var U=g.deleteDatabase(e.name);U.onerror=function(){var H=U.result;H&&H.close(),B(U.error)},U.onblocked=function(){console.warn('dropInstance blocked for database "'+e.name+'" until all open connections are closed')},U.onsuccess=function(){var H=U.result;H&&H.close(),D(H)}});return P.then(function(D){b.db=D;for(var B=0;B<m.length;B++){var U=m[B];$(U._dbInfo)}}).catch(function(D){throw(V(e,D)||u.resolve()).catch(function(){}),D})})}return _(a,n),a}var wt={_driver:"asyncStorage",_initStorage:dt,_support:E(),iterate:gt,getItem:ht,setItem:pt,removeItem:bt,clear:mt,length:vt,key:yt,keys:Et,dropInstance:Tt};function Ct(){return typeof openDatabase=="function"}var ee="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",xt="~~local_forage_type~",Fe=/^~~local_forage_type~([^~]+)~/,ue="__lfsc__:",ve=ue.length,ye="arbf",Ee="blob",ke="si08",De="ui08",Be="uic8",Oe="si16",Me="si32",He="ur16",We="ui32",Ue="fl32",$e="fl64",Ye=ve+ye.length,ze=Object.prototype.toString;function Ve(e){var n=e.length*.75,t=e.length,o,a=0,r,l,h,b;e[e.length-1]==="="&&(n--,e[e.length-2]==="="&&n--);var m=new ArrayBuffer(n),v=new Uint8Array(m);for(o=0;o<t;o+=4)r=ee.indexOf(e[o]),l=ee.indexOf(e[o+1]),h=ee.indexOf(e[o+2]),b=ee.indexOf(e[o+3]),v[a++]=r<<2|l>>4,v[a++]=(l&15)<<4|h>>2,v[a++]=(h&3)<<6|b&63;return m}function Te(e){var n=new Uint8Array(e),t="",o;for(o=0;o<n.length;o+=3)t+=ee[n[o]>>2],t+=ee[(n[o]&3)<<4|n[o+1]>>4],t+=ee[(n[o+1]&15)<<2|n[o+2]>>6],t+=ee[n[o+2]&63];return n.length%3===2?t=t.substring(0,t.length-1)+"=":n.length%3===1&&(t=t.substring(0,t.length-2)+"=="),t}function _t(e,n){var t="";if(e&&(t=ze.call(e)),e&&(t==="[object ArrayBuffer]"||e.buffer&&ze.call(e.buffer)==="[object ArrayBuffer]")){var o,a=ue;e instanceof ArrayBuffer?(o=e,a+=ye):(o=e.buffer,t==="[object Int8Array]"?a+=ke:t==="[object Uint8Array]"?a+=De:t==="[object Uint8ClampedArray]"?a+=Be:t==="[object Int16Array]"?a+=Oe:t==="[object Uint16Array]"?a+=He:t==="[object Int32Array]"?a+=Me:t==="[object Uint32Array]"?a+=We:t==="[object Float32Array]"?a+=Ue:t==="[object Float64Array]"?a+=$e:n(new Error("Failed to get type for BinaryArray"))),n(a+Te(o))}else if(t==="[object Blob]"){var r=new FileReader;r.onload=function(){var l=xt+e.type+"~"+Te(this.result);n(ue+Ee+l)},r.readAsArrayBuffer(e)}else try{n(JSON.stringify(e))}catch(l){console.error("Couldn't convert value into a JSON string: ",e),n(null,l)}}function St(e){if(e.substring(0,ve)!==ue)return JSON.parse(e);var n=e.substring(Ye),t=e.substring(ve,Ye),o;if(t===Ee&&Fe.test(n)){var a=n.match(Fe);o=a[1],n=n.substring(a[0].length)}var r=Ve(n);switch(t){case ye:return r;case Ee:return I([r],{type:o});case ke:return new Int8Array(r);case De:return new Uint8Array(r);case Be:return new Uint8ClampedArray(r);case Oe:return new Int16Array(r);case He:return new Uint16Array(r);case Me:return new Int32Array(r);case We:return new Uint32Array(r);case Ue:return new Float32Array(r);case $e:return new Float64Array(r);default:throw new Error("Unkown type: "+t)}}var we={serialize:_t,deserialize:St,stringToBuffer:Ve,bufferToString:Te};function Ge(e,n,t,o){e.executeSql("CREATE TABLE IF NOT EXISTS "+n.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],t,o)}function Rt(e){var n=this,t={db:null};if(e)for(var o in e)t[o]=typeof e[o]!="string"?e[o].toString():e[o];var a=new u(function(r,l){try{t.db=openDatabase(t.name,String(t.version),t.description,t.size)}catch(h){return l(h)}t.db.transaction(function(h){Ge(h,t,function(){n._dbInfo=t,r()},function(b,m){l(m)})},l)});return t.serializer=we,a}function te(e,n,t,o,a,r){e.executeSql(t,o,a,function(l,h){h.code===h.SYNTAX_ERR?l.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[n.storeName],function(b,m){m.rows.length?r(b,h):Ge(b,n,function(){b.executeSql(t,o,a,r)},r)},r):r(l,h)},r)}function It(e,n){var t=this;e=w(e);var o=new u(function(a,r){t.ready().then(function(){var l=t._dbInfo;l.db.transaction(function(h){te(h,l,"SELECT * FROM "+l.storeName+" WHERE key = ? LIMIT 1",[e],function(b,m){var v=m.rows.length?m.rows.item(0).value:null;v&&(v=l.serializer.deserialize(v)),a(v)},function(b,m){r(m)})})}).catch(r)});return _(o,n),o}function At(e,n){var t=this,o=new u(function(a,r){t.ready().then(function(){var l=t._dbInfo;l.db.transaction(function(h){te(h,l,"SELECT * FROM "+l.storeName,[],function(b,m){for(var v=m.rows,S=v.length,P=0;P<S;P++){var D=v.item(P),B=D.value;if(B&&(B=l.serializer.deserialize(B)),B=e(B,D.key,P+1),B!==void 0){a(B);return}}a()},function(b,m){r(m)})})}).catch(r)});return _(o,n),o}function Ke(e,n,t,o){var a=this;e=w(e);var r=new u(function(l,h){a.ready().then(function(){n===void 0&&(n=null);var b=n,m=a._dbInfo;m.serializer.serialize(n,function(v,S){S?h(S):m.db.transaction(function(P){te(P,m,"INSERT OR REPLACE INTO "+m.storeName+" (key, value) VALUES (?, ?)",[e,v],function(){l(b)},function(D,B){h(B)})},function(P){if(P.code===P.QUOTA_ERR){if(o>0){l(Ke.apply(a,[e,b,t,o-1]));return}h(P)}})})}).catch(h)});return _(r,t),r}function Lt(e,n,t){return Ke.apply(this,[e,n,t,1])}function Pt(e,n){var t=this;e=w(e);var o=new u(function(a,r){t.ready().then(function(){var l=t._dbInfo;l.db.transaction(function(h){te(h,l,"DELETE FROM "+l.storeName+" WHERE key = ?",[e],function(){a()},function(b,m){r(m)})})}).catch(r)});return _(o,n),o}function Nt(e){var n=this,t=new u(function(o,a){n.ready().then(function(){var r=n._dbInfo;r.db.transaction(function(l){te(l,r,"DELETE FROM "+r.storeName,[],function(){o()},function(h,b){a(b)})})}).catch(a)});return _(t,e),t}function Ft(e){var n=this,t=new u(function(o,a){n.ready().then(function(){var r=n._dbInfo;r.db.transaction(function(l){te(l,r,"SELECT COUNT(key) as c FROM "+r.storeName,[],function(h,b){var m=b.rows.item(0).c;o(m)},function(h,b){a(b)})})}).catch(a)});return _(t,e),t}function kt(e,n){var t=this,o=new u(function(a,r){t.ready().then(function(){var l=t._dbInfo;l.db.transaction(function(h){te(h,l,"SELECT key FROM "+l.storeName+" WHERE id = ? LIMIT 1",[e+1],function(b,m){var v=m.rows.length?m.rows.item(0).key:null;a(v)},function(b,m){r(m)})})}).catch(r)});return _(o,n),o}function Dt(e){var n=this,t=new u(function(o,a){n.ready().then(function(){var r=n._dbInfo;r.db.transaction(function(l){te(l,r,"SELECT key FROM "+r.storeName,[],function(h,b){for(var m=[],v=0;v<b.rows.length;v++)m.push(b.rows.item(v).key);o(m)},function(h,b){a(b)})})}).catch(a)});return _(t,e),t}function Bt(e){return new u(function(n,t){e.transaction(function(o){o.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(a,r){for(var l=[],h=0;h<r.rows.length;h++)l.push(r.rows.item(h).name);n({db:e,storeNames:l})},function(a,r){t(r)})},function(o){t(o)})})}function Ot(e,n){n=A.apply(this,arguments);var t=this.config();e=typeof e!="function"&&e||{},e.name||(e.name=e.name||t.name,e.storeName=e.storeName||t.storeName);var o=this,a;return e.name?a=new u(function(r){var l;e.name===t.name?l=o._dbInfo.db:l=openDatabase(e.name,"","",0),e.storeName?r({db:l,storeNames:[e.storeName]}):r(Bt(l))}).then(function(r){return new u(function(l,h){r.db.transaction(function(b){function m(D){return new u(function(B,U){b.executeSql("DROP TABLE IF EXISTS "+D,[],function(){B()},function(H,X){U(X)})})}for(var v=[],S=0,P=r.storeNames.length;S<P;S++)v.push(m(r.storeNames[S]));u.all(v).then(function(){l()}).catch(function(D){h(D)})},function(b){h(b)})})}):a=u.reject("Invalid arguments"),_(a,n),a}var Mt={_driver:"webSQLStorage",_initStorage:Rt,_support:Ct(),iterate:At,getItem:It,setItem:Lt,removeItem:Pt,clear:Nt,length:Ft,key:kt,keys:Dt,dropInstance:Ot};function Ht(){try{return typeof localStorage!="undefined"&&"setItem"in localStorage&&!!localStorage.setItem}catch(e){return!1}}function Qe(e,n){var t=e.name+"/";return e.storeName!==n.storeName&&(t+=e.storeName+"/"),t}function Wt(){var e="_localforage_support_test";try{return localStorage.setItem(e,!0),localStorage.removeItem(e),!1}catch(n){return!0}}function Ut(){return!Wt()||localStorage.length>0}function $t(e){var n=this,t={};if(e)for(var o in e)t[o]=e[o];return t.keyPrefix=Qe(e,n._defaultConfig),Ut()?(n._dbInfo=t,t.serializer=we,u.resolve()):u.reject()}function Yt(e){var n=this,t=n.ready().then(function(){for(var o=n._dbInfo.keyPrefix,a=localStorage.length-1;a>=0;a--){var r=localStorage.key(a);r.indexOf(o)===0&&localStorage.removeItem(r)}});return _(t,e),t}function zt(e,n){var t=this;e=w(e);var o=t.ready().then(function(){var a=t._dbInfo,r=localStorage.getItem(a.keyPrefix+e);return r&&(r=a.serializer.deserialize(r)),r});return _(o,n),o}function Vt(e,n){var t=this,o=t.ready().then(function(){for(var a=t._dbInfo,r=a.keyPrefix,l=r.length,h=localStorage.length,b=1,m=0;m<h;m++){var v=localStorage.key(m);if(v.indexOf(r)===0){var S=localStorage.getItem(v);if(S&&(S=a.serializer.deserialize(S)),S=e(S,v.substring(l),b++),S!==void 0)return S}}});return _(o,n),o}function Gt(e,n){var t=this,o=t.ready().then(function(){var a=t._dbInfo,r;try{r=localStorage.key(e)}catch(l){r=null}return r&&(r=r.substring(a.keyPrefix.length)),r});return _(o,n),o}function Kt(e){var n=this,t=n.ready().then(function(){for(var o=n._dbInfo,a=localStorage.length,r=[],l=0;l<a;l++){var h=localStorage.key(l);h.indexOf(o.keyPrefix)===0&&r.push(h.substring(o.keyPrefix.length))}return r});return _(t,e),t}function Qt(e){var n=this,t=n.keys().then(function(o){return o.length});return _(t,e),t}function Xt(e,n){var t=this;e=w(e);var o=t.ready().then(function(){var a=t._dbInfo;localStorage.removeItem(a.keyPrefix+e)});return _(o,n),o}function Jt(e,n,t){var o=this;e=w(e);var a=o.ready().then(function(){n===void 0&&(n=null);var r=n;return new u(function(l,h){var b=o._dbInfo;b.serializer.serialize(n,function(m,v){if(v)h(v);else try{localStorage.setItem(b.keyPrefix+e,m),l(r)}catch(S){(S.name==="QuotaExceededError"||S.name==="NS_ERROR_DOM_QUOTA_REACHED")&&h(S),h(S)}})})});return _(a,t),a}function jt(e,n){if(n=A.apply(this,arguments),e=typeof e!="function"&&e||{},!e.name){var t=this.config();e.name=e.name||t.name,e.storeName=e.storeName||t.storeName}var o=this,a;return e.name?a=new u(function(r){e.storeName?r(Qe(e,o._defaultConfig)):r(e.name+"/")}).then(function(r){for(var l=localStorage.length-1;l>=0;l--){var h=localStorage.key(l);h.indexOf(r)===0&&localStorage.removeItem(h)}}):a=u.reject("Invalid arguments"),_(a,n),a}var qt={_driver:"localStorageWrapper",_initStorage:$t,_support:Ht(),iterate:Vt,getItem:zt,setItem:Jt,removeItem:Xt,clear:Yt,length:Qt,key:Gt,keys:Kt,dropInstance:jt},Zt=function(n,t){return n===t||typeof n=="number"&&typeof t=="number"&&isNaN(n)&&isNaN(t)},en=function(n,t){for(var o=n.length,a=0;a<o;){if(Zt(n[a],t))return!0;a++}return!1},Xe=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"},ie={},Je={},oe={INDEXEDDB:wt,WEBSQL:Mt,LOCALSTORAGE:qt},tn=[oe.INDEXEDDB._driver,oe.WEBSQL._driver,oe.LOCALSTORAGE._driver],de=["dropInstance"],Ce=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(de),nn={description:"",driver:tn.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function rn(e,n){e[n]=function(){var t=arguments;return e.ready().then(function(){return e[n].apply(e,t)})}}function xe(){for(var e=1;e<arguments.length;e++){var n=arguments[e];if(n)for(var t in n)n.hasOwnProperty(t)&&(Xe(n[t])?arguments[0][t]=n[t].slice():arguments[0][t]=n[t])}return arguments[0]}var on=function(){function e(n){T(this,e);for(var t in oe)if(oe.hasOwnProperty(t)){var o=oe[t],a=o._driver;this[t]=a,ie[a]||this.defineDriver(o)}this._defaultConfig=xe({},nn),this._config=xe({},this._defaultConfig,n),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return e.prototype.config=function(t){if((typeof t=="undefined"?"undefined":y(t))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var o in t){if(o==="storeName"&&(t[o]=t[o].replace(/\W/g,"_")),o==="version"&&typeof t[o]!="number")return new Error("Database version must be a number.");this._config[o]=t[o]}return"driver"in t&&t.driver?this.setDriver(this._config.driver):!0}else return typeof t=="string"?this._config[t]:this._config},e.prototype.defineDriver=function(t,o,a){var r=new u(function(l,h){try{var b=t._driver,m=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!t._driver){h(m);return}for(var v=Ce.concat("_initStorage"),S=0,P=v.length;S<P;S++){var D=v[S],B=!en(de,D);if((B||t[D])&&typeof t[D]!="function"){h(m);return}}var U=function(){for(var se=function(cn){return function(){var ln=new Error("Method "+cn+" is not implemented by the current driver"),je=u.reject(ln);return _(je,arguments[arguments.length-1]),je}},_e=0,sn=de.length;_e<sn;_e++){var Se=de[_e];t[Se]||(t[Se]=se(Se))}};U();var H=function(se){ie[b]&&console.info("Redefining LocalForage driver: "+b),ie[b]=t,Je[b]=se,l()};"_support"in t?t._support&&typeof t._support=="function"?t._support().then(H,h):H(!!t._support):H(!0)}catch(X){h(X)}});return R(r,o,a),r},e.prototype.driver=function(){return this._driver||null},e.prototype.getDriver=function(t,o,a){var r=ie[t]?u.resolve(ie[t]):u.reject(new Error("Driver not found."));return R(r,o,a),r},e.prototype.getSerializer=function(t){var o=u.resolve(we);return R(o,t),o},e.prototype.ready=function(t){var o=this,a=o._driverSet.then(function(){return o._ready===null&&(o._ready=o._initDriver()),o._ready});return R(a,t,t),a},e.prototype.setDriver=function(t,o,a){var r=this;Xe(t)||(t=[t]);var l=this._getSupportedDrivers(t);function h(){r._config.driver=r.driver()}function b(S){return r._extend(S),h(),r._ready=r._initStorage(r._config),r._ready}function m(S){return function(){var P=0;function D(){for(;P<S.length;){var B=S[P];return P++,r._dbInfo=null,r._ready=null,r.getDriver(B).then(b).catch(D)}h();var U=new Error("No available storage method found.");return r._driverSet=u.reject(U),r._driverSet}return D()}}var v=this._driverSet!==null?this._driverSet.catch(function(){return u.resolve()}):u.resolve();return this._driverSet=v.then(function(){var S=l[0];return r._dbInfo=null,r._ready=null,r.getDriver(S).then(function(P){r._driver=P._driver,h(),r._wrapLibraryMethodsWithReady(),r._initDriver=m(l)})}).catch(function(){h();var S=new Error("No available storage method found.");return r._driverSet=u.reject(S),r._driverSet}),R(this._driverSet,o,a),this._driverSet},e.prototype.supports=function(t){return!!Je[t]},e.prototype._extend=function(t){xe(this,t)},e.prototype._getSupportedDrivers=function(t){for(var o=[],a=0,r=t.length;a<r;a++){var l=t[a];this.supports(l)&&o.push(l)}return o},e.prototype._wrapLibraryMethodsWithReady=function(){for(var t=0,o=Ce.length;t<o;t++)rn(this,Ce[t])},e.prototype.createInstance=function(t){return new e(t)},e}(),an=new on;f.exports=an},{3:3}]},{},[4])(4)})});var xn={};bn(xn,{default:()=>me});module.exports=mn(xn);var ct=require("obsidian");var Y=require("obsidian");var Q=Ze(Ie()),ge=require("obsidian");var ce=/\^\[[^^`\n]+\]/g,le=/^[^\S\r\n]*(#{1,6}) +(.*)/m;async function nt(d,i){console.log("Tab Panels: Loading cache from Database");let s="Tab Panels: Finished loading cache ins";console.time(s);try{await Q.iterate((c,f)=>{let x=d.getCache(f);if(!x){i.vault.getFileByPath(f)?console.error("Tab Panels: Cannot get cacheMetadata from file. Path: ",f):(console.warn("Tab Panels: Cannot find file. Path: ",f,`
Removing cache from db`),Q.removeItem(f).catch(T=>console.error("Tab Panels: Error deleting cache from db. File path: ",f,`
ERROR: `,T)));return}ot(x),at(x,c),it(x,d,f);let y=i.vault.getFileByPath(f);y?(d.trigger("changed",y),d.trigger("resolve",y)):console.error(`Tab Panels: Cannot find file.
 Path: `,f)})}catch(c){console.error(`Tab Panels: Error loading cache from db to cachedMetadata. 
ERROR: `,c);return}console.timeEnd(s)}async function Ae(d,i){let s;try{s=await Q.getItem(i),s&&(await Q.setItem(d.path,s),await Q.removeItem(i))}catch(c){console.error("Tab Panels: Error updating from db. File path: ",d.path,`
ERROR: `,c);return}}async function Le(d){try{await Q.removeItem(d.path)}catch(i){console.error("Tab Panels: Error deleting cache from db. File path: ",d.path,`
ERROR: `,i);return}}async function rt(d){new ge.Notice("Tab Panels: Rebuilding cache...",3e3);let i="Tab Panels: Build time";console.time(i);try{let s=d.app;Q.clear();let c=d.app.vault.getMarkdownFiles();for(let f of c){let x=await d.app.vault.cachedRead(f),y=d.app.metadataCache.getFileCache(f);if(!y){console.error("Tab Panels: Error getting cache for file: "+f.path);continue}Pe(d,f,x,y),s.metadataCache.trigger("resolve",s.vault.getFileByPath(f.path))}}catch(s){console.error(`Tab Panels: Error rebuilding vault cache.
ERROR: `,s),new ge.Notice("Tab Panels: Error rebuilding vault cache. Error:"+s),console.timeEnd(i);return}console.timeEnd(i),new ge.Notice("Tab Panels: Finished building cache",3e3)}async function Pe(d,i,s,c){let f=d.app.metadataCache,x={};ot(c);let y=new RegExp(`^ {0,3}(\`{3,}|~{3,}) *${d.settings.codeblockKeyword}[ \\w]*
([\\s\\S]*?)\\1`,"gm"),T=[...s.matchAll(y)],p=0,g=1,E=!1;for(let u of T){if(u.index===void 0){console.error(`Tab panels: Error when parsing markdown, splitting markdown blocks. Match index === undefined
Match:`,u);return}let _=u[2],R=new RegExp(`^ {0,3}(\`{3,}|~{3,}) *(?!${d.settings.codeblockKeyword})[ \\w]*
([\\s\\S]*?)\\1`,"gm"),w=[..._.matchAll(R)];for(let O=w.length-1;O>=0;O--){let z=w[O];z.index!=null&&(_=_.substring(0,z.index)+_.substring(z.index+z[0].length))}let A=s.slice(p,u.index);p=u.index,g+=A.split(`
`).length-1;let N={line:g,col:0,offset:u.index+u[1].length+5};vn(_,N,x)&&(E=!0)}E&&(at(c,x),it(c,f,i.path));let I=wn(s,c,x,T);I&&(E=I);try{E?await Q.setItem(i.path,x):await Q.removeItem(i.path)}catch(u){console.error("Tab Panels: Error updating cache in db. File path: ",i.path,`
ERROR: `,u);return}}function vn(d,i,s){let c=d.split(`
`),f=0;return c.forEach((x,y)=>{let T=i.line+y,p=i.offset+f;yn(x,T,p,s),En(x,T,p,s),Tn(x,T,p,s),f+=x.length+1}),Cn(d,i,s),s&&Object.keys(s).length>0}function yn(d,i,s,c){let f=/!?\[\[([^|\]]+)(?:\|([^\]]+))?\]\]/g,x=[...d.matchAll(f)];if(x.length>0){let y=[],T=[];x.forEach(p=>{var u;let g=p.index?p.index:0,E={line:i,col:g,offset:s+g},I={link:p[1],original:p[0],displayText:(u=p[2])!=null?u:p[1],position:{start:E,end:{line:E.line,col:E.col+p[0].length,offset:E.offset+p[0].length}}};p[0][0]!=="!"?y.push(I):T.push(I)}),c.links?c.links.push(...y):c.links=y,c.embeds?c.embeds.push(...T):c.embeds=T}}function En(d,i,s,c){let f=d.match(le);if(f){let x=f.index?f.index:0,y={line:i,col:x,offset:s+x},T={heading:f[2].trimEnd(),level:f[1].length,position:{start:y,end:{line:y.line,col:y.col+f[0].length,offset:y.offset+f[0].length}}};c.headings?c.headings.push(T):c.headings=[T]}}function Tn(d,i,s,c){let f=/(?<=^|\s)#[^\s~!@#$%^&*()+={}|:;"'<>?`[\]\\,.]+/g,x=[...d.matchAll(f)];if(x.length>0){let y=[];x.forEach(T=>{let p=T.index?T.index:0,g={line:i,col:p,offset:s+p},E={tag:T[0],position:{start:g,end:{line:g.line,col:g.col+T[0].length,offset:g.offset+T[0].length}}};y.push(E)}),c.tags?c.tags.push(...y):c.tags=y}}function wn(d,i,s,c){if(c.length===0)return!1;let f=-1,x=Number.MAX_SAFE_INTEGER,y=Number.MAX_SAFE_INTEGER,T=g=>{f=g;let E=c[g];E.index?x=E.index:(x=0,console.error("Rebuilding inline footnotes, regex match.index === ",E.index)),y=x+E.length},p=[...d.matchAll(ce)];return p.length===0?!1:(i.footnotes||(i.footnotes=[]),s.footnotes||(s.footnotes=[]),p.forEach((g,E)=>{var u,_,R;let I=(u=g.index)!=null?u:0;for(;I>x;){if(f>=c.length-1){console.error(`Rebuilding footnote cache, While loop went over number of tab matches.
`,"Index: ",f," | Matches: ",c.length);break}T(f++)}if(I<y){let w={line:0,col:I,offset:I+2},A={id:`[inline${E}`,position:{start:w,end:{line:w.line,col:w.col+g[0].length,offset:w.offset+g[0].length-3}}};(_=s.footnotes)==null||_.push(A);let N={...A,isFromTabPanels:!0};(R=i.footnotes)==null||R.push(N)}}),!0)}function Cn(d,i,s){let c=0,f=i.line,x=/^\[\^([^^`\n]+)]:([^^`\n]+(?:\n[^^`\n]+)?)$/gm,y=[...d.matchAll(x)];if(y.length>0){let T=[],p=[];y.forEach(g=>{if(!g.index){console.error("Tab panels: Parsing sections for footnote definition. Unknown match index value: ",g.index,`
Match:`,g);return}let E=d.slice(c,g.index);c=g.index,f+=E.split(`
`).length-1;let I=g.index?g.index:0,u={line:f,col:I,offset:g.index+i.offset},_={start:u,end:{line:u.line,col:u.col+g[0].length,offset:u.offset+g[0].length}},R={id:g[1],position:_};T.push(R);let w={footnoteId:g[1],type:"footnoteDefinition",position:_};p.push(w)}),s.footnotes?s.footnotes.push(...T):s.footnotes=T,s.sections?s.sections.push(...p):s.sections=p}}function ot(d){d.links&&(d.links=d.links.filter(i=>!i.isFromTabPanels)),d.embeds&&(d.embeds=d.embeds.filter(i=>!i.isFromTabPanels)),d.headings&&(d.headings=d.headings.filter(i=>!i.isFromTabPanels)),d.tags&&(d.tags=d.tags.filter(i=>!i.isFromTabPanels)),d.footnotes&&(d.footnotes=d.footnotes.filter(i=>!i.isFromTabPanels)),d.sections&&(d.sections=d.sections.filter(i=>!i.isFromTabPanels))}function at(d,i){var s,c,f,x,y,T;if(i.links&&i.links.length>0){let p=i.links.map(g=>({...g,isFromTabPanels:!0}));d.links?(s=d.links)==null||s.push(...p):d.links=p}if(i.embeds&&i.embeds.length>0){let p=i.embeds.map(g=>({...g,isFromTabPanels:!0}));d.embeds?(c=d.embeds)==null||c.push(...p):d.embeds=p}if(i.headings&&i.headings.length>0){let p=i.headings.map(g=>({...g,isFromTabPanels:!0}));d.headings?(f=d.headings)==null||f.push(...p):d.headings=p,d.headings.sort(tt)}if(i.tags&&i.tags.length>0){let p=i.tags.map(g=>({...g,isFromTabPanels:!0}));d.tags?(x=d.tags)==null||x.push(...p):d.tags=p}if(i.footnotes&&i.footnotes.length>0){let p=i.footnotes.map(E=>({...E,isFromTabPanels:!0}));d.footnotes?(y=d.footnotes)==null||y.push(...p):d.footnotes=p,d.footnotes.sort(tt);let g=0;d.footnotes.forEach((E,I)=>{E.id.startsWith("[inline")&&(E.id=`[inline${g++}`)})}if(i.sections&&i.sections.length>0){let p=i.sections.map(g=>({...g,isFromTabPanels:!0}));d.sections?(T=d.sections)==null||T.push(...p):d.sections=p}}function it(d,i,s){let c=d.links,f=i.resolvedLinks[s],x=i.unresolvedLinks[s];c&&c.forEach(y=>{if(!y.isFromTabPanels)return;let T=y.link,p=T.indexOf("#");p>0&&(T=T.substring(0,p));let g=i.getFirstLinkpathDest(T,""),E="",I;g===null?(I=x,E=T):(I=f,E=g.path),I[E]===void 0&&(I[E]=0),I[E]++})}function tt(d,i){let s=d.position.start.offset,c=i.position.start.offset;return s<c?-1:s>c?1:(console.warn("Tab Panels: Cache item with same offset",`
Cache A:`,d,"Cache B:",i),0)}var st={codeblockKeyword:"tabs",tabMarkerSyntax:"---",showNoTabWarning:!0,enableEditableTabs:!1,enterToExitEditing:!0,highlightSelectedTabName:!0,enableCaching:!1},pe=class extends Y.PluginSettingTab{constructor(s,c){super(s,c);this.plugin=c}display(){let{containerEl:s}=this,c=this.plugin.settings;s.empty(),new Y.Setting(s).setName("Codeblock keyword").addText(w=>w.setValue(c.codeblockKeyword).setPlaceholder("tabs").onChange(async A=>{c.codeblockKeyword=A.trim(),await this.plugin.saveSettings()}));let f=new DocumentFragment,x=()=>`${c.tabMarkerSyntax||"---"} New Tab`;f.detach(),f.appendText("Set the marker format that defines a new tab in your markdown"),f.appendChild(createEl("br")),f.appendText("Example: ");let y=createEl("code",{text:x()});f.appendChild(y);let T=createDiv({text:"No syntax detected. Default to ---",cls:"mod-warning"});f.appendChild(T);let p=()=>T.style.display=c.tabMarkerSyntax?"none":"block";p(),new Y.Setting(s).setName("Tab marker syntax").setDesc(f).addText(w=>w.setValue(c.tabMarkerSyntax).setPlaceholder("---, ===, tabs:").onChange(async A=>{c.tabMarkerSyntax=A.trim(),await this.plugin.saveSettings(),y.textContent=x(),p()})),new Y.Setting(s).setName("Show no tab warning").addToggle(w=>w.setValue(c.showNoTabWarning).onChange(async A=>{c.showNoTabWarning=A,await this.plugin.saveSettings()})),new Y.Setting(s).setHeading().setName("Styling"),new Y.Setting(s).setName("Highlight selected tab name").addToggle(w=>w.setValue(c.highlightSelectedTabName).onChange(async A=>{c.highlightSelectedTabName=A,await this.plugin.saveSettings()})),new Y.Setting(s).setHeading().setName("Experimental");let g=new DocumentFragment;g.appendText(`Allows editing tabs by clicking on it.
`),g.appendChild(createEl("a",{text:" Learn more",href:"https://github.com/GnoxNahte/obsidian-tab-panels/tree/main?tab=readme-ov-file#editing-content-experimental"})),g.appendChild(createEl("div",{text:"Since this feature will modify the vault and is experimental, it's recommended to have a backup of the vault.",cls:"mod-warning"})),g.appendChild(createEl("div",{text:"It generally works well but may behave unexpectedly depending on your plugins and theme.",cls:"mod-warning"})),new Y.Setting(s).setName("Enable editable tabs").setDesc(g).addToggle(w=>w.setValue(c.enableEditableTabs).onChange(async A=>{c.enableEditableTabs=A,new Y.Notice("Reload the vault to see changes",5e3),await this.plugin.saveSettings(),this.display()})),c.enableEditableTabs&&new Y.Setting(s).setName("Enter to exit editing").setDesc("When enabled, the Enter key will close the text field. Use Shift + Enter for a new line.").addToggle(w=>w.setValue(c.enterToExitEditing).onChange(async A=>{c.enterToExitEditing=A,await this.plugin.saveSettings()}));let E=new DocumentFragment;E.appendText(`Add additional information to Obsidian's cache.
`),E.appendChild(createEl("a",{text:" Learn more",href:"https://github.com/GnoxNahte/obsidian-tab-panels/tree/main#cache-experimental"})),E.appendChild(createEl("br")),E.appendText("This allows backlinks, outgoing links, headings, tags showing on the sidebar. Also supports renaming files, tags."),E.appendChild(createEl("br")),E.appendText("It should also allow other plugins that uses the cache like Dataview");let I=createEl("div",{text:"Since this is this is still experimental. ",cls:"mod-warning",parent:E}),u=createEl("ul",{parent:I});if(u.appendChild(createEl("li",{text:"Some things might not work as expected. Report issues "})).appendChild(createEl("a",{text:"here",href:"https://github.com/GnoxNahte/obsidian-tab-panels/issues/new/choose"})),u.appendChild(createEl("li",{text:"However, even if things go wrong, it shouldn't affect your files."})),u.appendChild(createEl("li",{text:"You can always revert it by disabling caching then reloading Obsidian"})),new Y.Setting(s).setName("Enable caching").setDesc(E).addToggle(w=>w.setValue(c.enableCaching).onChange(async A=>{c.enableCaching=A,await this.plugin.saveSettings(),this.display(),c.enableCaching&&(await this.plugin.loadCacheFromDb(),new Y.Notice("Tab Panels: Loading cache...",3e3))})),c.enableCaching){let w=new DocumentFragment;w.appendText("This is rebuilds the cache if you encounter syncing issues. "),w.appendChild(createEl("div",{text:"It might take sometime depending on the size of your vault",cls:"mod-warning"})),new Y.Setting(s).setName("Rebuild cache").setDesc(w).addButton(A=>A.setButtonText("Rebuild").setClass("mod-warning").onClick(async N=>{await rt(this.plugin)}))}let R=new DocumentFragment;R.appendText("Reload the app to apply changes"),R.appendChild(createEl("br")),R.appendChild(createEl("br")),R.appendText("Found bugs or want a feature? "),R.appendChild(createEl("a",{text:"Create a GitHub issue!",href:"https://github.com/GnoxNahte/obsidian-tab-panels/issues/new/choose"})),new Y.Setting(s).setDesc(R)}};var fe=require("obsidian");var be=class{constructor(i){this.plugin=i,this.tabsRegex=new RegExp(`^[^\\S\r
]*${this.plugin.settings.tabMarkerSyntax}[^\\S\r
]*(.*)`,"gm")}async create(i,s,c){var _;let f=/^ *~{3,}|`{3,}/gm;s.classList.add("tab-panel-container"),this.plugin.settings.highlightSelectedTabName&&s.classList.add("highlight-selected-tab-name");let x=createEl("div",{cls:"tab-scroll-container",parent:s}),y=createEl("ul",{cls:"tab-container",parent:x}),T=createDiv({cls:"content-container",parent:s}),p=this.tabsRegex,g=Array.from(i.matchAll(p));if(g.length>0){let R=i.substring(0,g[0].index),w=Array.from(R.matchAll(f));if(!this.checkIfCodeblockClosed(w)){let A=w[0],N=i.indexOf(A[0],((_=A.index)!=null?_:0)+1);if(N!==-1){let M=i.slice(0,N),O=Array.from(M.matchAll(p)).length;g.splice(0,O)}else g.length=0}}if(g.length===0){x.classList.add("hide-container");let R=this.renderMarkdown(T,"",i,c,0,this.countNewLines(i)+1);if(R.classList.add("selected"),this.plugin.settings.showNoTabWarning){let w=`> [!WARNING] No tabs created
> To create tabs, use '${this.plugin.settings.tabMarkerSyntax} Tab Name'. 
>For more info: [GitHub README](https://github.com/GnoxNahte/obsidian-tab-panels)
>To hide this popup: Settings > Hide no tab warning`;fe.MarkdownRenderer.render(this.plugin.app,w,R,c.sourcePath,this.plugin)}await this.modifyRenderedContent(i,s,c);return}let E=0,I=-1,u=1+this.countNewLines(i.substring(0,g[0].index));for(let R=0;R<g.length;R++){++I;let w=g[R][1],A=[],N="",M=createEl("li",{cls:"tab",parent:y}),O=w.match(/\(default\)\s*/i);O&&O.index&&(E=I,w=w.replace(O[0],""));let z=w.match(/\(css-?class: *([ \w-]*)\)/i);z&&z.index&&(A=z[1].split(" ").filter($=>$),M.addClasses(A),w=w.substring(0,z.index)+w.substring(z.index+z[0].length));let G=w.match(/\(css-?styles?:[ "]*([ :;\w-]*)[ "]*\)/i);G&&G.index&&(N=G[1],M.style.cssText=N,w=w.substring(0,G.index)+w.substring(G.index+G[0].length));let C=I;M.addEventListener("click",()=>this.switchTab(C,y,T)),fe.MarkdownRenderer.render(this.plugin.app,w,M,c.sourcePath,this.plugin);let F=$=>{var ne,re,q;let V=i.length,K=(re=(ne=g[R+1])==null?void 0:ne.index)!=null?re:V,J=R<g.length-1?K-1:V,j=i.substring((q=g[R].index)!=null?q:0,J);if($){let ae=j.indexOf(`
`);return ae!==-1?j.substring(ae+1):""}else return j},L=F(!0);do{let $=Array.from(L.matchAll(f));if(this.checkIfCodeblockClosed($))break;if(++R,R>=g.length)break;L+=F(!1)}while(R+1<g.length);let k=this.countNewLines(L)+1,W=this.renderMarkdown(T,w,L,c,u,k);A&&W.addClasses(A),N&&(W.style.cssText=N),u+=k+1}await this.modifyRenderedContent(i,s,c),this.switchTab(E,y,T,!0)}renderMarkdown(i,s,c,f,x,y){var I;let T=createDiv({parent:i}),p=i.parentElement;if(s){let u=createDiv({parent:T,cls:"pdf-tab-header tab selected"});fe.MarkdownRenderer.render(this.plugin.app,s,u,f.sourcePath,this.plugin)}let g=createDiv({parent:T,cls:"rendered-content"});if(fe.MarkdownRenderer.render(this.plugin.app,c,g,f.sourcePath,this.plugin),!this.plugin.settings.enableEditableTabs||((I=p.parentElement)==null?void 0:I.closest(".tab-panel-container"))!=null||p.closest(".el-pre")!=null)return T;let E=createEl("textarea",{parent:T,text:c});return E.addEventListener("keydown",u=>{this.plugin.settings.enterToExitEditing&&!u.shiftKey&&u.key=="Enter"&&E.blur()}),E.addEventListener("focusout",()=>{let u=f.getSectionInfo(p.firstElementChild);if(!u){console.error("Tab panels: Can't find section");return}if(c===E.value){this.toggleEditableContent(g,E,!1);return}let _=u.lineStart+x+1;this.toggleEditableContent(g,E,!1),this.replaceContent(_,_+y,E.value)}),g.addEventListener("click",u=>{u.stopImmediatePropagation(),this.toggleEditableContent(g,E,!0)}),this.toggleEditableContent(g,E,!1),T}toggleEditableContent(i,s,c){let f="hide-content";i.classList.toggle(f,c),s.classList.toggle(f,!c),c&&s.focus()}replaceContent(i,s,c){var T;c+=`
`;let f=(T=this.plugin.app.workspace.activeEditor)==null?void 0:T.editor;if(!f){console.error("Tab Panels: Can't find editor");return}let x={line:i,ch:0},y={line:s,ch:0};f.replaceRange(c,x,y)}checkIfCodeblockClosed(i){if(i===null||i.length===0)return!0;let s=[];for(let c of i){let f=s.indexOf(c[0]);f!==-1?s.splice(f):s.push(c[0])}return s.length===0}switchTab(i,s,c,f=!1){let x="selected",y=s.children;for(let I=0;I<y.length;I++)y[I].classList.remove(x);let T=c.children;for(let I=0;I<T.length;I++)T[I].classList.remove(x);let p=y[i];if(p.classList.add(x),T[i].classList.add(x),!f||i===0)return;if(s.parentElement===null){console.error("Tab Panels: Cannot find scroll element");return}function E(){setTimeout(()=>{if(s.parentElement===null)return;let I=p.offsetLeft;s.parentElement.scrollLeft=I-35,s.parentElement.scrollLeft===0&&E()},100)}E()}async modifyRenderedContent(i,s,c){if(!this.plugin.settings.enableCaching)return;let f=await this.getMarkdownBeforeCodeBlock(s,c);f&&(this.modifyInlineFootnotesPos(i,f,s),this.updateOutline(i,f,s))}async getMarkdownBeforeCodeBlock(i,s){let c=s.getSectionInfo(i);if(!c)return console.log("Tab Panels: Section info returning null"),null;let f=this.plugin.app.vault.getFileByPath(s.sourcePath);if(!f)return console.error("Tab Panels: Can't find file: ",s.sourcePath),null;let x=await this.plugin.app.vault.cachedRead(f),y=[...x.matchAll(/\n/g)];return c.lineStart>y.length?(console.error(`Tab Panels: Error, section info line start larger than number of lines in markdown. 
Line end:`,c.lineStart,`
Number of lines from markdown: `,y.length),null):x.substring(0,y[c.lineStart].index)}modifyInlineFootnotesPos(i,s,c){let f=[...s.matchAll(ce)].length,x=c.querySelector(".content-container");if(!x){console.error("Tab Panels: Can't find container");return}let y=x.querySelectorAll("a.footnote-link[data-footref]");[...i.matchAll(ce)].forEach((p,g)=>{let E=y[g];E.dataset.footref=`[inline${g+f}`})}async updateOutline(i,s,c){let f=le.flags;f.contains("g")||(f+="g");let x=RegExp(le,f),y=[...s.matchAll(x)].length,T=[...i.matchAll(x)].length;await new Promise(w=>setTimeout(w,200));let g=this.plugin.app.workspace.getLeavesOfType("outline")[0].view.containerEl,E=Array.from(g.querySelectorAll("div.tree-item-self.is-clickable")),I=y,u=y+T,_=E.slice(I,u);if(!c.closest(".markdown-reading-view"))return;let R=Array.from(c.querySelectorAll(".markdown-reading-view :is(h1,h2,h3,h4,h5,h6)"));if(_.length!==R.length){console.error("Outline heading length and headings in tab panels rendered markdown doesn't match up",`
Outline Headings:`,_.map(w=>w.textContent),`
Headings in plugin:`,R.map(w=>w.textContent));return}_.forEach((w,A)=>{w.addEventListener("click",N=>{N.preventDefault();let M=R[A];M.classList.add("is-flashing"),setTimeout(()=>{M.classList.remove("is-flashing")},3e3),M.scrollIntoView()})})}countNewLines(i){return(i.match(/\n/g)||"").length}};var lt=Ze(Ie()),me=class extends ct.Plugin{constructor(){super(...arguments);this.onMetadataCacheChangedHandler=this.onMetadataCacheChanged.bind(this);this.loadCacheFromDbHandler=this.loadCacheFromDb.bind(this);this.debug_outputMetadataCacheHandler=this.debug_outputMetadataCache.bind(this)}async onload(){if(this.isCacheLoaded=!1,await this.loadSettings(),this.tabPanelBuilder=new be(this),this.registerMarkdownCodeBlockProcessor(this.settings.codeblockKeyword,async(s,c,f)=>this.tabPanelBuilder.create(s,c,f)),this.settings.enableCaching){let s=this.app.appId||"shared";lt.config({name:`tab-panels/cache/${s}`}),this.app.workspace.onLayoutReady(this.loadCacheFromDbHandler),this.app.metadataCache.on("changed",this.onMetadataCacheChangedHandler),this.app.vault.on("rename",Ae),this.app.vault.on("delete",Le)}this.addSettingTab(new pe(this.app,this))}async loadSettings(){let s=Object.assign({},st,await this.loadData());this.settings=s,s.hideNoTabWarning&&(this.settings.showNoTabWarning=!s.hideNoTabWarning),await this.saveSettings()}async saveSettings(){await this.saveData(this.settings)}onunload(){this.app.metadataCache.off("changed",this.onMetadataCacheChangedHandler),this.app.vault.off("rename",Ae),this.app.vault.off("delete",Le)}async loadCacheFromDb(){await nt(this.app.metadataCache,this.app),this.isCacheLoaded=!0}async onMetadataCacheChanged(s,c,f){this.isCacheLoaded&&await Pe(this,s,c,f)}debug_outputMetadataCache(s,c,f){console.log("File: ",s.path,`Cache:
`,this.app.metadataCache.getCache(s.path),`
Resolved links`,this.app.metadataCache.resolvedLinks,`
Unresolved `,this.app.metadataCache.unresolvedLinks)}};
/*! Bundled license information:

localforage/dist/localforage.js:
  (*!
      localForage -- Offline Storage, Improved
      Version 1.10.0
      https://localforage.github.io/localForage
      (c) 2013-2017 Mozilla, Apache License 2.0
  *)
*/

/* nosourcemap */